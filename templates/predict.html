{% extends "layout.html" %}

{% block content %}

<h1 id="stock-name" class="ui header"></h1>
<table class="ui celled striped table">
    <thead>
        <tr>
            <th>Date</th>
            <th>Open</th>
            <th>High</th>
            <th>Low</th>
            <th>Close</th>
            <th>Volume</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
        </tr>
    </tbody>
</table>


<h1 class="ui header">Prediction Results</h1>
<div id="prediction-container" style="
        background: #fff;
        padding: 15px;
        margin-top: 15px;
        border-radius: 8px;
        box-shadow: 0px 0px 8px rgba(0, 0, 0, 0.1);
    ">
    <p style="font-size: 16px; font-weight: bold; color: #333;">Predicted Trend:</p>
    <p id="prediction-result" style="font-size: 20px; color: #28a745; font-weight: bold;">-</p>
    <p style="color: #666; font-size: 14px;">This predicted trend is based on the latest market trends,
        sentiment analysis, and technical indicators.</p>
</div>
<!-- <h2>Stock Prediction</h2>
        <form id="prediction-form">
            <label>Close Price: <input type="number" id="close" step="0.01"></label>
            <label>High Price: <input type="number" id="high" step="0.01"></label>
            <label>Low Price: <input type="number" id="low" step="0.01"></label>
            <label>Open Price: <input type="number" id="open" step="0.01"></label>
            <label>Volume: <input type="number" id="volume"></label>
            <label>Tweet Count: <input type="number" id="tweet_count"></label>
            <label>Sentiment Score: <input type="number" id="sentiment" step="0.01"></label>
            <button type="submit">Predict</button>
        </form>
        <h3>Prediction: <span id="prediction-result">-</span></h3> -->


<script>
    window.onload = async function () {
        let stockData = JSON.parse(localStorage.getItem("latestStockData"));
        document.getElementById("stock-name").innerText = stockData.stock_id + " Last day details"
        if (stockData) {
            document.querySelector("td:nth-child(1)").innerText = stockData.date || "-";
            document.querySelector("td:nth-child(2)").innerText = stockData.open || "-";
            document.querySelector("td:nth-child(3)").innerText = stockData.high || "-";
            document.querySelector("td:nth-child(4)").innerText = stockData.low || "-";
            document.querySelector("td:nth-child(5)").innerText = stockData.close || "-";
            document.querySelector("td:nth-child(6)").innerText = stockData.volume || "-";
        } else {
            console.log("No stock data found in localStorage.");
        }

        console.log(stockData)
        stockData = {
            Close: stockData.close,
            High: stockData.high,
            Low: stockData.low,
            Open: stockData.open,
            Volume: stockData.volume,
            Tweet_Count: 15000,
            Sentiment_Score: 0.9
        }

        const response = await fetch("http://127.0.0.1:8000/predict", {
            method: "POST",
            headers: {
                "Content-Type": "application/json"
            },
            body: JSON.stringify(stockData)
        });

        const result = await response.json();
        console.log(result, -1)
        document.getElementById("prediction-result").innerText = result.prediction;
    };

</script>


{% endblock %}